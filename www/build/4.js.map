{"version":3,"sources":["../../src/pages/park-details/park-details.module.ts","../../src/pages/park-details/park-details.ts"],"names":[],"mappings":"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","file":"4.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ParkDetailsPage } from './park-details';\n\n@NgModule({\n  declarations: [\n    ParkDetailsPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ParkDetailsPage),\n  ],\n})\nexport class ParkDetailsPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/park-details/park-details.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\r\nimport { AngularFireDatabase, FirebaseListObservable} from 'angularfire2/database';\r\nimport { Dialogs } from '@ionic-native/dialogs';\r\nimport * as firebase from 'firebase';\r\nimport { ParkAuthsPage } from '../park-auths/park-auths';\r\n\r\n/**\r\n * Generated class for the ParkDetailsPage page.\r\n *\r\n * See https://ionicframework.com/docs/components/#navigation for more info on\r\n * Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-park-details',\r\n  templateUrl: 'park-details.html',\r\n})\r\nexport class ParkDetailsPage {\r\n  check: Object;\r\n  key: any;\r\n  //parkDetailRef;toggle;\r\n  //detail: Array<Object> = [];\r\n  tog: FirebaseListObservable<any[]>;\r\n  auth: boolean;\r\n  checker: boolean;\r\n  parkDetailRef;toggle;\r\n  detail: Array<Object> = [];\r\n  analysis: FirebaseListObservable<any[]>;\r\n  parkName: string;\r\n/*\r\n  constructor(public navCtrl: NavController, public navParams: NavParams, public af:AngularFireDatabase, public dialogs: Dialogs) {\r\n  \r\n    this.check = navParams.data.parkData;\r\n    this.key = navParams.data.parkData.key;\r\n//    this.parkDetailRef = firebase.database().ref('/parks/'+this.key);\r\n    this.tog = af.list('/parks/'+this.key+'/detail/');\r\n //   this.tog2 = firebase.database().ref(`/parks/${this.key}/detail/`);\r\n    this.ifAuth();\r\n    this.ifChecker();\r\n//    window.alert(this.auth);\r\n  }*/\r\n\r\n  constructor(public navCtrl: NavController, public navParams: NavParams, public af:AngularFireDatabase, public dialogs: Dialogs) {\r\n    \r\n      this.parkDetailRef = firebase.database().ref('/parks/'+this.key);\r\n    \r\n      this.check = navParams.data.parkData;\r\n      this.key = navParams.data.parkData.key;\r\n  //    this.parkDetailRef = firebase.database().ref('/parks/'+this.key);\r\n      this.tog = af.list('/parks/'+this.key+'/detail/');\r\n      this.ifAuth();\r\n      this.ifChecker();\r\n      this.analysis = af.list('/analysis');\r\n      this.parkDetailRef.child('place').on('value',data=>{\r\n        this.parkName = data.val();\r\n      })\r\n\r\n    }\r\n\r\n  ionViewDidLoad() {\r\n    this.parkDetailRef.child('detail').on('value', data=>{\r\n      data.forEach(data => {\r\n       this.detail.push({\r\n          carnum: data.val().carnum,\r\n          toggle: data.val().toggle,\r\n          id: data.val().id})      \r\n    }); \r\n   });\r\n\r\n  }\r\n  \r\n  toggleButton(toggles:any){\r\n    //window.alert( toggles.toggle);\r\n\r\n      firebase.database().ref('/parks/'+this.key+'/detail/'+toggles.id+'/')\r\n      .update({carnum:toggles.carnum , toggle: !toggles.toggle});\r\n    \r\n      var d = new Date();\r\n      var week = new Array('일', '월', '화', '수', '목', '금', '토');\r\n      this.analysis.push({ 장소: this.parkName, 요일: week[d.getDay()], 시간: d.getHours() });\r\n \r\n  }\r\n\r\n  manage(){\r\n    var user = firebase.auth().currentUser;\r\n    var db = firebase.database().ref('/parks/'+this.key+'/managers');\r\n    var navCtrl = this.navCtrl;\r\n    var key = this.key;\r\n    db.orderByChild('key')\r\n    .equalTo(user.uid)\r\n    .once('value', function(snapshot){\r\n      if(snapshot.exists())\r\n      {\r\n        navCtrl.push(ParkAuthsPage,{id:key});\r\n      }\r\n      else\r\n      {\r\n   //     window.alert('unauthorized access');\r\n      }\r\n    })\r\n\r\n    \r\n  }\r\n\r\n  ifAuth(){\r\n    var user = firebase.auth().currentUser;\r\n    var key = this.key;\r\n    var valid = firebase.database().ref(`/parks/${key}/managers/`);\r\n    var check  = [];\r\n\r\n    valid.orderByChild('key')\r\n    .equalTo(user.uid)\r\n    .once('value',\r\n      function(snapshot)\r\n      {\r\n        if(snapshot.exists())\r\n        {\r\n          check.push(true);\r\n        }\r\n        else{\r\n          check.push(false);\r\n        }\r\n      });\r\n      \r\n      if(check[0])\r\n      {\r\n        this.auth = true;\r\n        return true;\r\n      }\r\n      else\r\n      {\r\n        this.auth = false;\r\n        return false;\r\n      }\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n  ifChecker(){\r\n    var user = firebase.auth().currentUser;\r\n    var key = this.key;\r\n    var valid = firebase.database().ref(`/parks/${key}/checkers/`);\r\n    var check  = [];\r\n\r\n    valid.orderByChild('key')\r\n    .equalTo(user.uid)\r\n    .once('value',\r\n      function(snapshot)\r\n      {\r\n        if(snapshot.exists())\r\n        {\r\n          check.push(true);\r\n        }\r\n        else{\r\n          check.push(false);\r\n        }\r\n      });\r\n      \r\n      if(check[0])\r\n      {\r\n        this.checker = true;\r\n        return true;\r\n      }\r\n      else\r\n      {\r\n        this.checker = false;\r\n        return false;\r\n      }\r\n  }\r\n\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/park-details/park-details.ts"],"sourceRoot":""}